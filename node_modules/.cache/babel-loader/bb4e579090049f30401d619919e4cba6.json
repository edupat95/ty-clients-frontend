{"ast":null,"code":"var _jsxFileName = \"/media/eduardo/DatosUbuntu/Universidad/TY Clients/ty-clients/frontend/ty-clients/src/pages/Login/Login.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { login } from '../../services/public.service';\nimport { createUserAdapter } from '../../adapters/user.adapter';\nimport { createUser } from '../../redux/states/user';\nimport \"./styles/Login.css\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Button } from '@mui/material';\nimport { Navigate } from 'react-router-dom';\nimport { getWorkerByUser, getCashierByWorker } from '../../services/public.service';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const Login = () => {\n  _s();\n\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const dispatch = useDispatch();\n  const userState = useSelector(store => store.user);\n  const [errorLogin, setErrorLogin] = useState('');\n  const [statusLogin, setStatusLogin] = useState(false);\n\n  const handleClick = async () => {\n    //console.log(\"Datos que tengo que mandar: \" + username + \" - \" + password);\n    const user = await login(username, password); //console.log(\"Login page/handleclick -> \" + JSON.stringify(user));\n\n    if (user === 401) {\n      console.log(\"Error en las credenciales\");\n      setErrorLogin(\"Error en las credenciales\");\n    } else if (user === 0) {\n      console.log(\"Error en el servidor\");\n      setErrorLogin(\"Error en el servidor\");\n    } else {\n      setErrorLogin('');\n      await dispatch(createUser(createUserAdapter(user)));\n      await localStorage.setItem('user', JSON.stringify(user));\n      const worker = await getWorkerByUser(user ? user === null || user === void 0 ? void 0 : user.id_token : \"\", user ? user === null || user === void 0 ? void 0 : user.id : 0);\n      const cashier = await getCashierByWorker(user ? user === null || user === void 0 ? void 0 : user.id_token : \"\", worker ? worker === null || worker === void 0 ? void 0 : worker.id : 0);\n      await localStorage.setItem('worker', JSON.stringify(worker));\n      await localStorage.setItem('cashier', JSON.stringify(cashier));\n      console.log(\"Desde login: \" + localStorage.getItem('user'), \"\\n Worker:\", localStorage.getItem('worker'), \"\\n Cajero:\", localStorage.getItem('cashier'));\n      setStatusLogin(true); //se puede redireccionar de otra forma, no se cual seria la mejor.\n    }\n  };\n\n  useEffect(() => {\n    localStorage.setItem('user', '');\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"containerPrincipal\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"containerSecundario\",\n        children: [statusLogin && userState.id_token !== '' && /*#__PURE__*/_jsxDEV(Navigate, {\n          to: \"/cashier\",\n          replace: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Usuario: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"inputsStyle\",\n          name: \"username\",\n          onChange: e => setUsername(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Contrase\\xF1a: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          className: \"inputsStyle\",\n          name: \"password\",\n          onChange: e => setPassword(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"button\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            size: \"small\",\n            color: \"success\",\n            onClick: () => handleClick(),\n            children: \"Login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: 15,\n            color: 'red'\n          },\n          children: errorLogin\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s(Login, \"As1TEBMEdhsiVe8cDouscPIi3XA=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useEffect","useState","login","createUserAdapter","createUser","useDispatch","useSelector","Button","Navigate","getWorkerByUser","getCashierByWorker","Login","username","setUsername","password","setPassword","dispatch","userState","store","user","errorLogin","setErrorLogin","statusLogin","setStatusLogin","handleClick","console","log","localStorage","setItem","JSON","stringify","worker","id_token","id","cashier","getItem","e","target","value","fontSize","color"],"sources":["/media/eduardo/DatosUbuntu/Universidad/TY Clients/ty-clients/frontend/ty-clients/src/pages/Login/Login.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport {login} from '../../services/public.service';\nimport {createUserAdapter} from '../../adapters/user.adapter'\nimport { createUser } from '../../redux/states/user';\nimport \"./styles/Login.css\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { AppStore } from '../../redux/store';\nimport { Button } from '@mui/material';\nimport { Navigate } from 'react-router-dom';\nimport { getWorkerByUser, getCashierByWorker } from '../../services/public.service';\nexport const Login = () => {\n  \n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState(''); \n  const dispatch = useDispatch();\n  const userState = useSelector((store: AppStore) => store.user); \n  const [errorLogin, setErrorLogin] = useState('');\n  const [statusLogin, setStatusLogin] = useState(false);\n\n  const handleClick = async () => {\n    //console.log(\"Datos que tengo que mandar: \" + username + \" - \" + password);\n    const user = await login(username, password); \n    //console.log(\"Login page/handleclick -> \" + JSON.stringify(user));\n    if(user === 401){\n      console.log(\"Error en las credenciales\");\n      setErrorLogin(\"Error en las credenciales\");\n    }else if (user === 0){\n      console.log(\"Error en el servidor\");\n      setErrorLogin(\"Error en el servidor\");\n    } else {\n      setErrorLogin('');\n      await dispatch(createUser(createUserAdapter(user)));\n      await localStorage.setItem('user', JSON.stringify(user));\n      const worker = await getWorkerByUser(user ? user?.id_token: \"\" , user ? user?.id : 0);\n      const cashier = await getCashierByWorker(user ? user?.id_token: \"\" , worker ? worker?.id : 0);\n      await localStorage.setItem('worker', JSON.stringify(worker));\n      await localStorage.setItem('cashier', JSON.stringify(cashier));\n      console.log(\"Desde login: \" + localStorage.getItem('user'), \"\\n Worker:\" , localStorage.getItem('worker'), \"\\n Cajero:\" , localStorage.getItem('cashier'));\n      setStatusLogin(true); //se puede redireccionar de otra forma, no se cual seria la mejor.\n    }\n    \n  };\n\n  useEffect(() => {\n    localStorage.setItem('user', '');\n  }, []);\n\n  return (\n    <>\n      <div className=\"containerPrincipal\">\n        <div className=\"containerSecundario\">\n          \n          {(statusLogin && userState.id_token !== '' ) && (\n            <Navigate to=\"/cashier\" replace={true} />\n          )}\n\n          <label>Usuario: </label>\n          <br />\n          <input\n            type=\"text\"\n            className=\"inputsStyle\"\n            name=\"username\"\n            onChange={ e => setUsername(e.target.value)}\n          />\n          <br />\n          <label>Contrase√±a: </label>\n          <br />\n          <input\n            type=\"password\"\n            className=\"inputsStyle\"\n            name=\"password\"\n            onChange={ e => setPassword(e.target.value)}\n          />\n          <br />\n          <div className='button'>\n            <Button variant=\"contained\" size='small' color=\"success\" onClick={()=> handleClick()}>Login</Button>\n          </div>  \n          <p style={{ fontSize: 15, color: 'red' }}>{errorLogin}</p>\n\n          \n        </div> \n      </div>\n    </>\n  );\n}\n\nexport default Login"],"mappings":"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"},"metadata":{},"sourceType":"module"}