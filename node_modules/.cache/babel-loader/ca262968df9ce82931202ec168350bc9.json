{"ast":null,"code":"var _jsxFileName = \"/media/eduardo/DatosUbuntu/Universidad/TY Clients/ty-clients/frontend/ty-clients/src/pages/Login/Login.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { login } from '../../services/public.service';\nimport { createUserAdapter } from '../../adapters/user.adapter';\nimport { createUser } from '../../redux/states/user';\nimport \"./styles/Login.css\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Button } from '@mui/material';\nimport { useNavigate } from 'react-router-dom';\nimport { getWorkerByUser, getCashierByWorker, getRecorderByWorker } from '../../services/public.service';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const Login = () => {\n  _s();\n\n  const navigate = useNavigate();\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const dispatch = useDispatch();\n  const userState = useSelector(store => store.user);\n  const [errorLogin, setErrorLogin] = useState(''); //const [statusLogin, setStatusLogin] = useState(false);\n\n  const handleClick = async () => {\n    //console.log(\"Datos que tengo que mandar: \" + username + \" - \" + password);\n    const user = await login(username, password); //console.log(\"Login page/handleclick -> \" + JSON.stringify(user));\n\n    if (user === 401) {\n      console.log(\"Error en las credenciales\");\n      setErrorLogin(\"Error en las credenciales\");\n    } else if (user === 0) {\n      console.log(\"Error en el servidor\");\n      setErrorLogin(\"Error en el servidor\");\n    } else {\n      setErrorLogin('');\n      await dispatch(createUser(createUserAdapter(user)));\n      await localStorage.setItem('user', JSON.stringify(user));\n      const worker = await getWorkerByUser(user ? user === null || user === void 0 ? void 0 : user.id_token : \"\", user ? user === null || user === void 0 ? void 0 : user.id : 0);\n\n      if (worker) {\n        const cashier = await getCashierByWorker(user ? user === null || user === void 0 ? void 0 : user.id_token : \"\", worker ? worker === null || worker === void 0 ? void 0 : worker.id : 0);\n\n        if (cashier) {\n          await localStorage.setItem('cashier', JSON.stringify(cashier)); //console.log(\"Desde login: \" + localStorage.getItem('user'),\"\\n Worker:\", cashier.worker , \"\\n Cajero:\" , cashier);\n\n          navigate(\"/cashier\");\n        } else {\n          console.log(\"ES UN REGISTRADOR\");\n          const recorder = await getRecorderByWorker(user ? user === null || user === void 0 ? void 0 : user.id_token : \"\", worker ? worker === null || worker === void 0 ? void 0 : worker.id : 0);\n\n          if (recorder) {\n            await localStorage.setItem('recorder', JSON.stringify(recorder)); //console.log(\"Desde login: \" + localStorage.getItem('user'),\"\\n Worker:\", recorder.worker , \"\\n Registrador:\" , recorder);\n\n            navigate(\"/associate-customer\");\n          }\n        }\n      } //await localStorage.setItem('worker', JSON.stringify(worker));\n      //setStatusLogin(true); //se puede redireccionar de otra forma, no se cual seria la mejor.\n\n    }\n  };\n\n  useEffect(() => {\n    localStorage.setItem('user', '');\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"containerPrincipal\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"containerSecundario\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Usuario: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"inputsStyle\",\n          name: \"username\",\n          onChange: e => setUsername(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Contrase\\xF1a: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          className: \"inputsStyle\",\n          name: \"password\",\n          onChange: e => setPassword(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"button\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            size: \"small\",\n            color: \"success\",\n            onClick: () => handleClick(),\n            children: \"Login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: 15,\n            color: 'red'\n          },\n          children: errorLogin\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s(Login, \"BHx0Jx60CsyXEOFfDIxMJZD7ZPw=\", false, function () {\n  return [useNavigate, useDispatch, useSelector];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useEffect","useState","login","createUserAdapter","createUser","useDispatch","useSelector","Button","useNavigate","getWorkerByUser","getCashierByWorker","getRecorderByWorker","Login","navigate","username","setUsername","password","setPassword","dispatch","userState","store","user","errorLogin","setErrorLogin","handleClick","console","log","localStorage","setItem","JSON","stringify","worker","id_token","id","cashier","recorder","e","target","value","fontSize","color"],"sources":["/media/eduardo/DatosUbuntu/Universidad/TY Clients/ty-clients/frontend/ty-clients/src/pages/Login/Login.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport {login} from '../../services/public.service';\nimport {createUserAdapter} from '../../adapters/user.adapter'\nimport { createUser } from '../../redux/states/user';\nimport \"./styles/Login.css\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { AppStore } from '../../redux/store';\nimport { Button } from '@mui/material';\nimport { Navigate, useNavigate } from 'react-router-dom';\nimport { getWorkerByUser, getCashierByWorker, getRecorderByWorker } from '../../services/public.service';\n\n\nexport const Login = () => {\n  const navigate = useNavigate();\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState(''); \n  const dispatch = useDispatch();\n  const userState = useSelector((store: AppStore) => store.user); \n  const [errorLogin, setErrorLogin] = useState('');\n  //const [statusLogin, setStatusLogin] = useState(false);\n\n  const handleClick = async () => {\n    //console.log(\"Datos que tengo que mandar: \" + username + \" - \" + password);\n    const user = await login(username, password); \n    //console.log(\"Login page/handleclick -> \" + JSON.stringify(user));\n    if(user === 401){\n      console.log(\"Error en las credenciales\");\n      setErrorLogin(\"Error en las credenciales\");\n    }else if (user === 0){\n      console.log(\"Error en el servidor\");\n      setErrorLogin(\"Error en el servidor\");\n    } else {\n      setErrorLogin('');\n      await dispatch(createUser(createUserAdapter(user)));\n      await localStorage.setItem('user', JSON.stringify(user));\n      const worker = await getWorkerByUser(user ? user?.id_token: \"\" , user ? user?.id : 0);\n      if(worker){\n        const cashier = await getCashierByWorker(user ? user?.id_token: \"\" , worker ? worker?.id : 0);\n        if(cashier){\n          await localStorage.setItem('cashier', JSON.stringify(cashier));\n          //console.log(\"Desde login: \" + localStorage.getItem('user'),\"\\n Worker:\", cashier.worker , \"\\n Cajero:\" , cashier);\n          navigate(\"/cashier\");\n        } else {\n          console.log(\"ES UN REGISTRADOR\");\n          const recorder = await getRecorderByWorker(user ? user?.id_token: \"\" , worker ? worker?.id : 0);\n          if(recorder){\n            await localStorage.setItem('recorder', JSON.stringify(recorder));\n            //console.log(\"Desde login: \" + localStorage.getItem('user'),\"\\n Worker:\", recorder.worker , \"\\n Registrador:\" , recorder);\n            navigate(\"/associate-customer\");\n          }\n        }\n      }\n      //await localStorage.setItem('worker', JSON.stringify(worker));\n      //setStatusLogin(true); //se puede redireccionar de otra forma, no se cual seria la mejor.\n    }\n    \n  };\n\n  useEffect(() => {\n    localStorage.setItem('user', '');\n  }, []);\n\n  return (\n    <>\n      <div className=\"containerPrincipal\">\n        <div className=\"containerSecundario\">\n          \n          <label>Usuario: </label>\n          <br />\n          <input\n            type=\"text\"\n            className=\"inputsStyle\"\n            name=\"username\"\n            onChange={ e => setUsername(e.target.value)}\n          />\n          <br />\n          <label>Contraseña: </label>\n          <br />\n          <input\n            type=\"password\"\n            className=\"inputsStyle\"\n            name=\"password\"\n            onChange={ e => setPassword(e.target.value)}\n          />\n          <br />\n          <div className='button'>\n            <Button variant=\"contained\" size='small' color=\"success\" onClick={()=> handleClick()}>Login</Button>\n          </div>  \n          <p style={{ fontSize: 15, color: 'red' }}>{errorLogin}</p>\n\n          \n        </div> \n      </div>\n    </>\n  );\n}\n\nexport default Login"],"mappings":"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"},"metadata":{},"sourceType":"module"}